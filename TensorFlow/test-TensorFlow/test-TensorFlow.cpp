#include <stdint.h>
#include "pico/stdlib.h"
#include "jxglib/LABOPlatform.h"
#include "mnist_model.h"
#include "tensorflow/lite/micro/micro_interpreter.h"
#include "tensorflow/lite/micro/micro_log.h"
//#include "tensorflow/lite/micro/micro_op_resolver.h"
#include "tensorflow/lite/micro/micro_mutable_op_resolver.h"
#include "tensorflow/lite/micro/system_setup.h"
#include "tensorflow/lite/schema/schema_generated.h"

using namespace jxglib;

const uint8_t mnist_digit_0[784] = {
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,120,200,255,255,255,200,120,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,100,200,255,255,255,255,255,255,200,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,150,255,255,200,150,100,150,200,255,255,150,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,150,255,255,150,0,0,0,0,0,150,255,255,150,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,200,255,180,0,0,0,0,0,0,0,180,255,200,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,255,255,100,0,0,0,0,0,0,0,100,255,255,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,255,255,100,0,0,0,0,0,0,0,100,255,255,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,200,255,180,0,0,0,0,0,0,0,180,255,200,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,150,255,255,150,0,0,0,0,0,150,255,255,150,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,150,255,255,200,150,100,150,200,255,255,150,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,100,200,255,255,255,255,255,255,200,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,120,200,255,255,255,200,120,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};

const uint8_t mnist_digit_1[784] = {
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,120,255,120,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,120,255,255,120,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,255,255,255,120,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,120,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,120,255,255,120,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,180,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
};

const uint8_t mnist_digit_2[784] = {
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,100,180,255,255,255,180,100,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,150,255,255,255,255,255,255,255,150,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,180,255,180,100,0,100,180,255,255,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,255,255,180,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,180,255,255,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,150,255,255,100,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,255,255,180,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,150,255,255,200,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,150,255,255,180,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,150,255,255,150,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,150,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,120,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,120,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,120,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,120,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,150,255,255,180,180,180,180,180,180,180,180,180,180,150,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,100,0,0,0,0,0,0,0,0,
    0,0,0,0,0,180,255,255,255,255,255,255,255,255,255,255,255,255,255,100,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
};

const uint8_t mnist_digit_3[784] = {
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,100,180,255,255,255,180,100,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,150,255,255,255,255,255,255,255,150,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,100,180,150,100,0,100,200,255,255,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,255,255,150,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,180,255,255,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,120,200,255,255,180,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,150,200,255,255,255,255,180,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,150,255,255,255,255,200,100,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,100,150,200,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,150,255,255,150,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,255,255,180,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,180,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,100,150,0,0,0,0,0,255,255,180,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,180,255,100,0,0,0,100,255,255,180,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,180,255,255,180,150,180,255,255,255,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,100,200,255,255,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,100,180,255,255,255,200,100,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};

#include <stdint.h>

const uint8_t mnist_digit_4[784] = {
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,100,200,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,100,200,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,100,200,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,100,200,255,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,100,200,255,150,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,100,200,255,100,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,100,200,255,100,0,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,100,200,255,100,0,0,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,100,200,255,100,0,0,0,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,100,200,255,100,0,0,0,0,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,100,200,255,150,150,150,150,150,150,255,255,255,255,200,100,0,0,0,0,0,0,0,0,0,0,0,
    0,0,200,255,255,255,255,255,255,255,255,255,255,255,255,255,200,100,0,0,0,0,0,0,0,0,0,0,
    0,0,100,150,150,150,150,150,150,150,150,255,255,255,255,200,100,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
};

const uint8_t mnist_digit_5[784] = {
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,100,180,255,255,255,255,255,255,180,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,255,255,180,200,255,255,180,100,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,100,150,150,180,200,255,255,255,255,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,150,255,255,180,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,180,255,255,100,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,180,255,255,100,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,100,0,0,0,0,0,100,255,255,180,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,150,200,100,0,100,180,255,255,255,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,120,255,255,255,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,120,180,255,255,255,180,100,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};
const uint8_t mnist_digit_6[784] = {
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,100,180,255,255,180,100,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,100,200,255,255,255,255,255,200,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,150,255,255,200,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,180,255,200,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,180,150,200,255,255,180,100,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,255,180,100,100,180,255,255,255,100,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,180,0,0,0,0,100,255,255,180,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,100,0,0,0,0,0,180,255,255,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,150,255,255,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,150,255,255,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,100,0,0,0,0,0,180,255,255,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,180,0,0,0,0,100,255,255,180,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,255,180,100,100,180,255,255,255,100,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,180,255,255,255,255,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,150,200,255,255,255,255,255,200,100,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,100,180,200,200,180,100,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
};

const uint8_t mnist_digit_7[784] = {
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,100,180,255,255,255,255,255,255,255,255,180,100,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,200,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,100,150,150,150,150,150,180,255,255,255,255,200,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,180,255,255,180,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,255,255,100,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,150,255,200,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,255,255,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,180,255,180,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,100,255,255,100,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,180,255,180,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,100,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,180,255,150,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,100,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,180,255,150,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,100,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,150,255,150,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};

const uint8_t mnist_digit_8[784] = {
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,120,255,255,255,120,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,180,255,255,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,255,255,180,0,0,180,255,255,255,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,255,255,0,0,0,0,255,255,255,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,255,255,0,0,0,0,255,255,255,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,180,255,180,0,0,180,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,180,255,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,180,255,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,180,255,255,180,180,255,255,180,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,180,255,255,0,0,0,0,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,180,0,0,0,0,180,255,255,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,0,0,0,0,0,0,255,255,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,255,255,180,0,0,0,0,180,255,255,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,180,255,255,180,0,0,180,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,180,255,255,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,120,255,255,255,255,120,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
};

const uint8_t mnist_digit_9[784] = {
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,100,180,255,255,255,180,100,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,120,255,255,255,255,255,255,200,100,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,120,255,255,180,100,120,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,180,255,200,0,0,0,150,255,255,255,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,200,255,150,0,0,0,0,150,255,255,180,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,180,255,255,100,0,0,100,255,255,255,100,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,120,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,120,255,255,255,255,255,255,255,180,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,100,150,150,180,255,255,255,150,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,120,255,255,255,100,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,180,255,255,180,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,120,255,255,200,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,120,255,255,200,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,120,255,255,180,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,180,255,255,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,100,180,180,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
    0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
};

template<size_t arenaSize, unsigned int tOpCount> class TFLiteRunner {
private:
	const uint8_t* modelData_;
	std::unique_ptr<tflite::MicroMutableOpResolver<tOpCount>> resolver_;
	std::unique_ptr<tflite::MicroInterpreter> interpreter_;
	alignas(16) uint8_t arena_[arenaSize];
public:
	TFLiteRunner(const uint8_t* modelData);
	~TFLiteRunner() {}
public:
	bool Initialize();
	bool Invoke();
public:
	size_t GetArenaUsedBytes() const { return interpreter_->arena_used_bytes(); }
	TfLiteTensor* GetInput(int index) { return interpreter_->input(index); }
	TfLiteTensor* GetOutput(int index) { return interpreter_->output(index); }
};

template<size_t arenaSize, unsigned int tOpCount>
	TFLiteRunner<arenaSize, tOpCount>::TFLiteRunner(const uint8_t* modelData) : modelData_(modelData)
{
}

template<size_t arenaSize, unsigned int tOpCount> bool TFLiteRunner<arenaSize, tOpCount>::Initialize()
{
	tflite::InitializeTarget();
	const tflite::Model* model = tflite::GetModel(modelData_);
	if (model->version() != TFLITE_SCHEMA_VERSION) return false;
	resolver_.reset(new tflite::MicroMutableOpResolver<tOpCount>());
	interpreter_.reset(new tflite::MicroInterpreter(model, *resolver_, arena_, arenaSize));
	resolver_->AddConv2D();
	resolver_->AddMaxPool2D();
	resolver_->AddFullyConnected();
	resolver_->AddReshape();
	resolver_->AddSoftmax();
	if (interpreter_->AllocateTensors() != kTfLiteOk) return false;
	return true;
}

template<size_t arenaSize, unsigned int tOpCount> bool TFLiteRunner<arenaSize, tOpCount>::Invoke()
{
	return interpreter_->Invoke() == kTfLiteOk;
}

TFLiteRunner<32768, 8> tfLiteRunner(conv_mnist_quant_tflite);

ShellCmd(testtf, "test TensorFlow Lite Micro")
{
	const uint8_t* mnist_digit_tbl[] = {
		mnist_digit_0,
		mnist_digit_1,
		mnist_digit_2,
		mnist_digit_3,
		mnist_digit_4,
		mnist_digit_5,
		mnist_digit_6,
		mnist_digit_7,
		mnist_digit_8,
		mnist_digit_9,
	};
	TfLiteTensor* input = tfLiteRunner.GetInput(0);
	TfLiteTensor* output = tfLiteRunner.GetOutput(0);
	//printf("input->type: %d\n", input->type);
	//printf("output->type: %d\n", output->type);
	for (int j = 0; j < count_of(mnist_digit_tbl); j++) {
		const uint8_t* mnist_digit = mnist_digit_tbl[j];
		for(int i = 0; i < 784; i++) {
			input->data.int8[i] = (int8_t)((int)mnist_digit[i] - 128);
		}
		if (!tfLiteRunner.Invoke()) {
			printf("Invoke failed!\n");
			return Result::Error;
		}
		printf("Digit %d:\n", j);
		for (int i = 0; i < 10; i++) {
			::printf("output[%d] = %d\n", i, output->data.int8[i]);
		}
	}
	//for(int i = 0; i < 784; i++) {
	//	input->data.int8[i] = (int8_t)((int)mnist_digit_4[i] - 128);
	//}
	//if (!tfLiteRunner.Invoke()) {
	//	printf("Invoke failed!\n");
	//	return Result::Error;
	//}
	//for (int i = 0; i < 10; i++) {
	//	::printf("output[%d] = %d\n", i, output->data.int8[i]);
	//}
	return Result::Success;
}

int main(void)
{
	::stdio_init_all();
	if (!tfLiteRunner.Initialize()) {
		printf("TFLiteRunner Initialize failed!\n");
		return 1;
	}
	//printf("arena %d bytes used\n", tfLiteRunner.GetArenaUsedBytes());
	LABOPlatform::Instance.AttachStdio().Initialize();
	//LABOPlatform::Instance.Initialize();
	for (;;) Tickable::Tick();
	//for (;;) ::tight_loop_contents();
}
